<ResourceDictionary
    x:Class="NINA.Plugins.PlateSolvePlus.Options"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Converters.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <DataTemplate x:Key="PlateSolvePlus_Options">
       
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Orientation="Vertical" Margin="10" Width="520">

                <TextBlock Text="PlateSolvePlus – Guide Scope Plate Solving"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10"/>

                <!-- ========== Guider Capture ========== -->
                <GroupBox Header="Guider Capture" Margin="0,0,0,10">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="220"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Exposure (seconds)"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding GuideExposureSeconds, UpdateSourceTrigger=PropertyChanged}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Gain (-1 = ignore/auto)"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding GuideGain, UpdateSourceTrigger=PropertyChanged}"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Binning (1,2,3…)"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding GuideBinning, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>
                </GroupBox>

                <!-- ========== Optics / Scale ========== -->
                <GroupBox Header="Guide Scope / Scale" Margin="0,0,0,10">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="220"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Focal length (mm)"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding GuideFocalLengthMm, UpdateSourceTrigger=PropertyChanged}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Use camera pixel size (if available)"/>
                        <CheckBox Grid.Row="1" Grid.Column="1" Margin="8,2,0,2"
                                  IsChecked="{Binding UseCameraPixelSize}"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Pixel size (µm) – used if not from camera"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="8,2,0,2"
                         Text="{Binding GuidePixelSizeUm,
                                Converter={StaticResource DoubleConverter},
                                UpdateSourceTrigger=PropertyChanged}"/>


                    </Grid>
                </GroupBox>

                <!-- ========== Solver ========== -->
                <GroupBox Header="Plate Solver Settings" Margin="0,0,0,10">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="220"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Search radius (deg)"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding SolverSearchRadiusDeg, UpdateSourceTrigger=PropertyChanged}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Timeout (seconds)"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding SolverTimeoutSec, UpdateSourceTrigger=PropertyChanged}"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Downsample (1..)" />
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="8,2,0,2"
                                 Text="{Binding SolverDownsample, UpdateSourceTrigger=PropertyChanged}"/>
                    </Grid>
                </GroupBox>

                <!-- ========== Offset ========== -->
                <GroupBox Header="Main ↔ Guide Offset" Margin="0,0,0,10">
                    <StackPanel Margin="10">
                        <CheckBox Content="Enable offset correction"
                                  IsChecked="{Binding OffsetEnabled}"
                                  Margin="0,0,0,8"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Offset RA (arcsec)"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Margin="8,2,0,2"
                                     Text="{Binding OffsetRaArcsec, UpdateSourceTrigger=PropertyChanged}"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Offset Dec (arcsec)"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Margin="8,2,0,2"
                                     Text="{Binding OffsetDecArcsec, UpdateSourceTrigger=PropertyChanged}"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Last calibrated (UTC)"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Margin="8,2,0,2"
                                     IsReadOnly="True"
                                     Text="{Binding OffsetLastCalibratedUtc}"/>
                        </Grid>

                        <TextBlock Margin="0,8,0,0" Opacity="0.8" TextWrapping="Wrap">
                            Tip: You will get the best results by calibrating the offset once after you have set up the guider and main scope.
                            The plugin will later apply this correction to guide-camera solves.
                        </TextBlock>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>
    </DataTemplate>
</ResourceDictionary>
